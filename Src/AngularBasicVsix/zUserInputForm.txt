using Common;
using System;
using System.Drawing;
using System.Windows.Forms;

namespace AngularBasicVsix
{
    public partial class UserInputForm : Form 
    {
        public UserInputForm(string solutionDirectory, string tempDirectory, string generatorName, string regularProjectName)
        {
            SuspendLayout();
            AddFormControls(solutionDirectory, tempDirectory, generatorName, regularProjectName);
            DefineFormSettings();
            ResumeLayout(false);
            PerformLayout();
        }

        private void AddFormControls(string solutionDirectory, string tempDirectory, string generatorName, string regularProjectName)
        {
            var label1 = new Label
            {
                //Location = new Point(25, 22),//gregt auto-position ?
                Name = "label1",
                Text = DialogHelper.GetLabelText(solutionDirectory, tempDirectory, generatorName, regularProjectName)
            };

            var btnOk = new Button
            {
                DialogResult = DialogResult.OK,
                Location = new Point(label1.Location.X, 400),//gregt auto-position ?
                Name = "btnOk",
                TabIndex = 0,
                Text = DialogHelper.Ok,
            };

            var btnCancel = new Button
            {
                DialogResult = DialogResult.Cancel,
                Location = new Point(btnOk.Location.X+77, btnOk.Location.Y),//gregt auto-position ?
                Name = "btnCancel",
                TabIndex = 1,
                Text = "Cancel",
            };

            // Button click events
            btnOk.Click += new EventHandler(btnOkCancel_Click);
            btnCancel.Click += new EventHandler(btnOkCancel_Click);

            // Shared
            btnCancel.Size = new Size(20, 14);
            btnOk.Size = btnCancel.Size;
            btnOk.AutoSize = btnCancel.AutoSize = label1.AutoSize = true;
            btnOk.AutoSizeMode = btnCancel.AutoSizeMode = AutoSizeMode.GrowOnly;
            btnOk.UseVisualStyleBackColor = btnCancel.UseVisualStyleBackColor = true;

            // Docking
            btnOk.Dock = btnCancel.Dock = label1.Dock = DockStyle.Top;
            //var panel = new Panel();
            //panel.Dock = DockStyle.Bottom;
            //panel.AutoScroll = false;
            //panel.AutoSize = true;
            //panel.AutoSizeMode = AutoSizeMode.GrowOnly;

            // Add controls to form
            Controls.Add(label1);
            Controls.Add(btnOk);
            Controls.Add(btnCancel);
            //panel.Controls.Add(btnCancel);
            //panel.Controls.Add(btnOk);
            //panel.Controls.Add(label1);          
            //Controls.Add(panel);
        }

        private void btnOkCancel_Click(object sender, EventArgs e)
        {
            Close();
        }

        /// <summary>
        /// AutoSizeMode.GrowAndShrink
        ///  The control grows or shrinks to fit its contents.
        ///  The control cannot be resized manually.
        /// AutoSizeMode.GrowOnly
        ///  The control grows as much as necessary to fit its contents but does not shrink smaller than the value of its System.Windows.Forms.Control.Size property.
        ///  The form can be resized, but cannot be made so small that any of its contained controls are hidden.
        /// </summary>
        private void DefineFormSettings()
        {
            AutoSize = true;
            AutoSizeMode = AutoSizeMode.GrowOnly;
            ClientSize = new Size(200, 100);
            //increase font size, but on reflection doesn't look too good...
            //Font = new Font(Font.FontFamily, Font.SizeInPoints + 1);
            Name = "UserInputForm";
            Padding = new Padding(10);
        }
    }
}